<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <title>An Intuitive System</title> <meta content="To filter HTTP traffic, Curiefense uses an intuitive tag-based system. It's flexible and powerful, but still straightforward to understand and use. Here's how it works. " name="description"> <meta content="An Intuitive System" property="og:title"> <meta content="To filter HTTP traffic, Curiefense uses an intuitive tag-based system. It's flexible and powerful, but still straightforward to understand and use. Here's how it works. " property="og:description"> <meta content="https://assets.website-files.com/5f906e60f009d620eb2024dd/5fab726ec93b28ec252e165e_Main_diagram-01-p-1080.png" property="og:image"> <meta content="An Intuitive System" property="twitter:title"> <meta content="To filter HTTP traffic, Curiefense uses an intuitive tag-based system. It's flexible and powerful, but still straightforward to understand and use. Here's how it works. " property="twitter:description"> <meta content="https://assets.website-files.com/5f906e60f009d620eb2024dd/5fab726ec93b28ec252e165e_Main_diagram-01-p-1080.png" property="twitter:image"> <meta property="og:type" content="website"> <meta content="summary_large_image" name="twitter:card"> <meta content="width=device-width, initial-scale=1" name="viewport"> <link href="/css/normalize.css" rel="stylesheet" type="text/css"> <link href="/css/components.css" rel="stylesheet" type="text/css"> <link href="/css/curiefense.css" rel="stylesheet" type="text/css"> <!-- <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script> <script type="text/javascript">WebFont.load({ google: { families: ["Inconsolata:400,700", "Rubik:regular,500,700", "Roboto:regular,italic,500,700"] } });</script> <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] --> <!-- <script type="text/javascript">!function (o, c) { var n = c.documentElement, t = " w-mod-"; n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch") }(window, document);</script> --> <link href="/images/favicon.png" rel="shortcut icon" type="image/x-icon"> <link href="/images/webclip.png" rel="apple-touch-icon"> <style> /*body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; }*/ .w-slider-dot { width: 10px; height: 10px; background: #C0CEE6; margin-bottom: 13px; } .w-slider-dot.w-active { background: #014AC6; } ul.list li { list-style: none; position: relative; } ul.list li::before { content: ''; display: inline-block; height: 16px; width: 16px; background-size: 100%; background-repeat: no-repeat; background-image: url(https://uploads-ssl.webflow.com/5f906e60f009d620eb2024dd/5f99e1f2fb15070ef945c1a0_tick.png); position: absolute; top: 4px; left: -25px; } ul.list.contrast li::before { background-image: url(https://uploads-ssl.webflow.com/5f906e60f009d620eb2024dd/5f99e8706336051698f5a977_tick_contrast.png); } </style> <!-- Global site tag (gtag.js) - Google Analytics --> <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-GS3KLXMBN3"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-GS3KLXMBN3'); </script> </head> <body class="body"> <!-- <div class="w-embed w-script"> <script id="mcjs">!function (c, h, i, m, p) { m = c.createElement(h), p = c.getElementsByTagName(h)[0], m.async = 1, m.src = i, p.parentNode.insertBefore(m, p) }(document, "script", "https://chimpstatic.com/mcjs-connected/js/users/0f9080ebe705d62b70f41d9b8/155c1b26293cfac10432375fa.js");</script> </div> --> <div data-collapse="medium" data-animation="over-right" data-duration="400" data-doc-height="1" data-no-scroll="1" role="banner" class="navigation w-nav"> <div class="navigation-container"> <a href="/" class="logo w-nav-brand"> <img src="/images/curie-01.svg" width="147" alt=""> </a> <div> <nav role="navigation" class="nav-menu w-nav-menu"> <a href="https://docs.curiefense.io/" target="_blank" class="nav-link w-nav-link">Docs</a> <a href="/features" class="nav-link w-nav-link">Features</a> <a href="/about-us" class="nav-link w-nav-link">About</a> <a href="/blog" class="nav-link w-nav-link">Blog</a> <a href="https://github.com/curiefense/curiefense.github.io/" target="_blank" class="nav-link nav-button w-nav-link"><em class="italic-text-2"></em> GitHub</a> </nav> <div class="menu-button w-nav-button"> <div class="menu-icon w-icon-nav-menu"></div> </div> </div> </div> </div> <div class="wrapper"> <div class="hero-nohome blog-post"> <div class="container w-container"></div> </div> <div class="section blog-post"> <div class="container w-container"> <div class="blog-post-wrapper"> <div class="blog-post-header"> <h3 class="heading-2">An Intuitive System</h3> <h1 class="hero-title nohome">An Intuitive System</h1> <div>An Intuitive System</div> </div> <div class="blog-post-main-image"> <img loading="lazy" src="https://uploads-ssl.webflow.com/5fa1500e10bda4bfdcb1b209/5fb32dcf78ac52d6491477a7_Traffic-CF-v1.0.png" alt=""> </div> <div class="rich-text-block w-richtext"> <p>A key element of every security system is its ease of use. One of Curiefense’s core principles (as discussed in the <a href="https://www.curiefense.io/manifesto">Manifesto</a>) is simplicity:&nbsp;<br /></p> <blockquote> <em> Simplicity is a vital ingredient in security. Complex systems tend to be abandoned, and complicated processes tend to be avoided. Even worse, a complicated system can be misconfigured, leading to an illusion of security when in fact there are vulnerabilities.<br /> <br /> Our goal is to keep Curiefense effective and simple to use, whether it is an API call, UI interaction, automation procedure, or a foundational concept. Simplicity boosts participation and promotes action. We will always choose to work harder to keep it as simple as possible, regardless of the complexity beneath the surface. </em> <br /> </blockquote> <p> Simplicity does not imply a lack of sophistication. On the contrary, Curiefense is designed to provide security powerful enough to handle threats (not only today’s, but also tomorrow’s), while still remaining understandable and straightforward to use.<br /> </p> <p>In this article, we’ll discuss a high-level overview of Curiefense’s traffic filtering. We’ll start with this diagram:</p> <p><br /></p> <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width: 1600px;"> <div> <img src="https://uploads-ssl.webflow.com/5fa1500e10bda4bfdcb1b209/5fb32c942d9b8d6e38700495_L84S5piX2Qm7yG46hzlVay2sND93oswbkgl_bpvzyTKfrC4-M0M9g773KyGZPZCxxAmcmWa-G9Tu4OQq0CNp-PjI-YH10bnLkIWdviiJx68_HcTf0_oNJBTicMPu3stYiqdwSuIy.png" width="auto" height="auto" loading="auto" /> </div> <figcaption><em>Two stages of real-time traffic processing</em></figcaption> </figure> <p><br /></p> <p> On the left are traffic sources, generating HTTP requests. The requests’ intended destination is the web resource (the site, app, service, or API) at the far right. To get there, they must pass through Curiefense and withstand its scrutiny. Only legitimate traffic is allowed through to the protected resource.<br /> </p> <p>The diagram illustrates two stages of Curiefense: <strong>Profiling</strong> and <strong>ACL Profiles</strong>. We’ll add more stages in a moment, but let’s discuss these two first.</p> <h2>Profiling</h2> <p>When Curiefense receives a request, it attaches internal tags to it. The tags will be the basis of subsequent processing in the ACL Profiles.<br /></p> <p>At this stage, no security policies are being enforced. Curiefense is merely creating a comprehensive profile for this request, by attaching all tags that are applicable to it.<br /></p> <p>The tags have several sources:</p> <ul> <li>Automatic generation</li> <li>External feeds</li> <li>Internal Profiling Lists<br /></li> </ul> <p><strong>Automatic generation</strong>: Curiefense generates many tags automatically. For example, every request receives tags containing its IP address, ASN, geolocation, and several others.<br /></p> <p> <strong>External feeds</strong>: You can subscribe Curiefense to multiple data feeds, and specify tags to be associated with them. For example, the Spamhaus project <a href="https://www.spamhaus.org/drop/">provides</a> DROP and EDROP&nbsp; “drop all traffic” advisory lists of IP addresses and AS numbers, consisting of netblocks that are used by professional spam or cyber-crime operations (for dissemination of malware, trojan downloaders, botnet controllers, etc.). Curiefense can attach an appropriate tag (perhaps “spamhaus”) to every incoming request originating from one of these hijacked/leased IPs. You could also subscribe to a feed containing IP addresses currently being used by VPNs, and attach a “vpn” tag to requests originating from one of them. And so on. </p> <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width: 2206px;"> <div><img src="https://uploads-ssl.webflow.com/5fa1500e10bda4bfdcb1b209/5fb334be97887168802ec433_Profiling%20Lists%20two.png" loading="lazy" width="auto" height="auto" /></div> <figcaption><em>The UI for subscribing to an external feed (in this example, Spamhaus DROP) and specifying the tag(s) to attach to requests which match it.</em></figcaption> </figure> <p> ‍<br /> Out of the box, Curiefense includes a substantial number of preloaded lists. (Currently, there are 18; more will be added soon.) These are automatically updated each day. </p> <p>‍<strong>Internal Profiling Lists</strong>: These are created by Curiefense administrators; they contain sets of criteria and the tags to attach when those criteria are matched. Some examples:</p> <ul> <li>Attach “internal” to requests from IPs used by internal teams</li> <li>Attach “forbidden” for all HTTP methods except for GET and POST</li> <li>Attach “debug” when the query string includes a <strong>debug</strong> parameter which is <strong>true</strong>.</li> <li>Attach “goodcookie” when the value of a specified cookie matches a regex of valid content. (Or when it <em>doesn’t</em> match a regex describing forbidden content.)<br /></li> </ul> <p> Profiling lists are a powerful tool. They allow you to define and attach tags depending on the content and characteristics of incoming requests: their headers, cookies, queries, paths, methods, geolocation, and more, with matching conditions specified as regex. For a full description, see the <a href="https://docs.curiefense.io/console/document-editor/profiling-lists">Curiefense documentation for Profiling Lists</a>.<br /> </p> <p>Once all tags are attached, it’s time to use them. That’s done with ACL Profiles.</p> <h2>ACL Profiles</h2> <p>Curiefense uses a request’s tags to enforce security policies. These are defined in an ACL (Access Control List) Profile. An ACL Profile defines the actions to take when certain tags are found, arranged in a sequential order.<br /></p> <p>Here’s an example in the Curiefense UI:</p> <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width: 2214px;"> <div><img src="https://uploads-ssl.webflow.com/5fa1500e10bda4bfdcb1b209/5fb32f8643c37a170d892a44_ACL%20Profiles%20two.png" loading="lazy" width="auto" height="auto" /></div> <figcaption><em>A sample ACL&nbsp;Profile in the Curiefense UI</em></figcaption> </figure> <p>‍</p> <p>Tags are arranged in columns. The columns are evaluated from left to right; if a request matches a tag in a column, the action for that column is taken.</p> <p>For the example above, this is how each request will be processed;</p> <ul> <li>If the request is tagged with <strong>spamhaus,</strong> <strong>vpn</strong>, or <strong>tor</strong>, block it.</li> <li>If the request is tagged with <strong>internal</strong>, allow it and exempt it from further processing.</li> <li>If the request is Google's crawler (having been tagged with <strong>googlebot</strong>), exit the ACL process and send the request to the WAF for further evaluation.</li> <li> If all tags have been evaluated but no matching ACL actions were found, subject the requestor to a <a href="https://docs.curiefense.io/reference/the-challenge-process">bot challenge</a> to verify this is a human user and not a bot. If the requestor fails the challenge, block it; otherwise, send the request to the WAF for further evaluation. </li> </ul> <p>In the diagram above are two additional columns, which aren't used in this example. Their actions are:</p> <ul> <li>Send the request to the WAF for evaluation without a bot challenge.</li> <li>Block the request.<br /></li> </ul> <p> A live deployment of Curiefense will usually have multiple ACL Profiles that are more extensive than the example described here, with different Profiles assigned to different paths/URLs throughout the protected application. Here’s a <a href="https://docs.curiefense.io/console/document-editor/acl-profiles"> full explanation of ACL Profiles and their capabilities</a>.<br /> </p> <p>In the example, you probably noticed that ACL Profile actions often result in the request being sent to the WAF for further evaluation. WAF processing occurs after ACL Profiles, as shown here:<br /></p> <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width: 1600px;"> <div> <img src="https://uploads-ssl.webflow.com/5fa1500e10bda4bfdcb1b209/5fb32c955ce12170b9892016_8LZDaeBU3Fu-JwJXe2fyn_rPdmqdRVjV776FojhA5hRCi1607QSljQCX5NWy7SaalcA6oDk4l1LIdsYgYui9_cIbr18eSH_hZbGBLgNctt0rgzfYsDf5UyugEZ4rMGJllv6a9ZKN.png" width="auto" height="auto" loading="auto" /> </div> <figcaption><em>WAF evaluation occurs after ACL Profiles</em></figcaption> </figure> <p> The Curiefense WAF enforces a number of rulesets, and blocks requests which do not meet them. This includes a wide variety of protective mechanisms against attacks such as SQL injection, code/command injection, cross-site scripting, and so on.<br /> </p> <p> In addition, custom rulesets can be defined for any combination of headers, cookies, and arguments. This includes content filtering: a request can be blocked if it contains certain content, or conversely if it <em>doesn’t</em> contain certain content. A later article will cover the Curiefense WAF in more detail.&nbsp;<br /> </p> <p>Now it’s time to complete the diagram by adding the one remaining stage of processing.</p> <h2>Rate Limiting</h2> <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width: 1600px;"> <div> <img src="https://uploads-ssl.webflow.com/5fa1500e10bda4bfdcb1b209/5fb32c94cb1bfc90e1f891c9_xowYh8ajZe7ixE0LQHI-aqgh6M9X6XXJXrvwqrN4GTIsWIh9UbCi_-Zm7Kkqo6QU2PxDFzk9zoywniNdEQhAtflQ1bD5Pkt1_rZ80-zSWPyvzQCd8CvaXT7IZIDPyV1y_nohX3Fg.png" width="auto" height="auto" loading="auto" /> </div> <figcaption><em>Rate&nbsp;Limits are enforced before ACL&nbsp;Profiles</em></figcaption> </figure> <p>After tags are attached, but before ACL Profiles are evaluated, Curiefense enforces Rate Limits. These are rulesets which define the frequency and timing with which a traffic source is allowed to access a given resource.&nbsp;<br /></p> <p>This has many uses, including:</p> <ul> <li>Protecting login forms against credential stuffing and other brute-force attacks</li> <li>Protecting checkout pages against payment card validation</li> <li>Protecting sites against scraping</li> <li>Protecting shopping pages (products, travel reservations, etc.) from inventory denial attacks<br /></li> </ul> <p>Rate Limiting rules are straightforward to set up, but they are quite powerful in their capabilities. A later article will explore Curiefense’s Rate Limiting capabilities in more detail.</p> <h2>Conclusion</h2> <p> This has been an overview of Curiefense’s real-time traffic processing. The main takeaway is this: Curiefense operates according to an intuitive tagging system. Each incoming request receives a set of tags describing its characteristics, and then the tags are evaluated to determine the action that is taken.&nbsp;<br /> </p> <p>There are many more capabilities of Curiefense that we didn’t have a chance to discuss above; they will be covered in future articles. Stay tuned!</p> <p><br /></p> </div> </div> </div> </div> </div> <div class="section footer"> <div class="container w-container"> <div class="w-row"> <div class="w-col w-col-4"><img src="/images/curie-01.svg" height="50" width="147" alt=""> <div class="footer-description"> <p class="paragraph">Curiefense is named in honor of the famous scientist <a href="marie-curie" target="_blank">Marie Curie</a>. The first version was developed in Malakoff, France, a few hundred meters from her home and laboratory. Curiefense was originally created by <a href="https://www.reblaze.com/" target="_blank">Reblaze</a>.<br></p> </div> <div class="footer-copyright">© Curiefense Contributors 2020-2021</div> <div class="columns w-row"> <div class="w-col w-col-2 w-col-small-3 w-col-tiny-3"> <a href="https://github.com/curiefense" target="_blank" class="w-inline-block"><img src="/images/github.svg" loading="lazy" width="30" height="30" alt=""></a> </div> <div class="w-col w-col-2 w-col-small-3 w-col-tiny-3"> <a href="https://twitter.com/curiefense" target="_blank" class="w-inline-block"><img src="/images/twitter.svg" loading="lazy" width="35" height="28" alt=""></a> </div> <div class="w-col w-col-2 w-col-small-3 w-col-tiny-3"> <a href="https://join.slack.com/t/curiefense/shared_invite/zt-nc8lyrjo-JJoY2mwrqNOfkmoA6ycTHg" target="_blank" class="w-inline-block"><img src="/images/slack.svg" loading="lazy" width="30" height="30" alt=""></a> </div> <div class="w-col w-col-6 w-col-small-3 w-col-tiny-3"> <a href="https://www.linkedin.com/company/curiefense" target="_blank" class="w-inline-block"><img src="/images/linkedin.svg" loading="lazy" width="30" height="30" alt=""></a> </div> </div> <div class="columns w-row"> <div class="w-col w-col-6 w-col-small-3 w-col-tiny-3"> <a href="https://github.com/curiefense/curiefense.github.io/tree/main/an-intuitive-system.md">Edit This Page</a> </div> </div> </div> <div class="w-col w-col-2"></div> <div class="w-col w-col-2"> <ul role="list" class="footer-list"> <li class="footer-list-item bold-text-2"><b>Docs</b></li> <li class="footer-list-item"><a href="https://docs.curiefense.io/installation/getting-started-with-curiefense" target="_blank" class="footer-list-item-link">Getting Started</a></li> <li class="footer-list-item"><a href="https://www.katacoda.com/curiefense" target="_blank" class="footer-list-item-link">Try Curiefense</a></li> <li class="footer-list-item"><a href="/faq" class="footer-list-item-link">FAQ</a></li> <li class="footer-list-item"><a href="https://github.com/curiefense/curiefense/blob/master/ROADMAP.md" target="_blank" class="footer-list-item-link">Roadmap</a></li> </ul> </div> <div class="w-col w-col-2"> <ul role="list" class="footer-list second"> <li class="footer-list-item"><b>Community</b></li> <li class="footer-list-item"><a href="https://join.slack.com/t/curiefense/shared_invite/zt-nc8lyrjo-JJoY2mwrqNOfkmoA6ycTHg" target="_blank" class="footer-list-item-link">Slack</a></li> <li class="footer-list-item"><a href="http://eepurl.com/hnnmpj" target="_blank" class="footer-list-item-link">Newsletter</a></li> <li class="footer-list-item"><a href="https://github.com/curiefense/curiefense/blob/master/CODE_OF_CONDUCT.md" target="_blank" class="footer-list-item-link">Code of Conduct</a></li> <li class="footer-list-item"><a href="/contact-us" class="footer-list-item-link">Contact Us</a></li> </ul> </div> <div class="w-col w-col-2"> <ul role="list" class="footer-list second"> <li class="footer-list-item"><b>Other</b></li> <li class="footer-list-item"><a href="/blog" class="footer-list-item-link">Blog</a></li> <li class="footer-list-item"><a href="https://podcast.curiefense.io/" target="_blank" class="footer-list-item-link">Podcast</a></li> <li class="footer-list-item"><a href="https://twitter.com/curiefense" target="_blank" class="footer-list-item-link">Twitter</a></li> <li class="footer-list-item"><a href="https://github.com/curiefense/curiefense" target="_blank" class="footer-list-item-link">GitHub</a></li> </ul> </div> </div> </div> <div class="container-2 w-container"> <a href="https://www.cncf.io/sandbox-projects/" target="_blank" class="w-inline-block"><img src="/images/cncf-sandbox-horizontal-color.svg" loading="lazy" width="150" height="35" alt="" class="image-8"></a> </div> <div class="w-container"> <div class="text-block-4">© 2021 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. <br>For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/en/trademark-usage/" target="_blank">Trademark Usage</a> page.</div> </div> </div> <div class="w-embed w-script"> <script id="mcjs">!function (c, h, i, m, p) { m = c.createElement(h), p = c.getElementsByTagName(h)[0], m.async = 1, m.src = i, p.parentNode.insertBefore(m, p) }(document, "script", "https://chimpstatic.com/mcjs-connected/js/users/0f9080ebe705d62b70f41d9b8/155c1b26293cfac10432375fa.js");</script> </div> <!-- <script defer async src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script> --> <script defer async type="text/javascript">WebFont.load({ google: { families: ["Inconsolata:400,700", "Rubik:regular,500,700", "Roboto:regular,italic,500,700"] } });</script> <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] --> <!-- <script defer async type="text/javascript">!function (o, c) { var n = c.documentElement, t = " w-mod-"; n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch") }(window, document);</script> --> <!-- <script defer async src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=5f906e60f009d620eb2024dd" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script> --> <!-- <script defer async src="/js/curiefense.js" type="text/javascript"></script> --> <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] --> </body> </html>
